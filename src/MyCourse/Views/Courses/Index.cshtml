
@model List<CourseViewModel>

<script type="text/javascript">
            $(document).ready(function()    {
                // eventuale codice javascript
            });
</script>


<h1>@ViewData["Title"]</h1>

<div class = "row">
<div class="col-md-4">


</div>

@{
        
        string ordinamento = "popolarità";
        string ricerca = "";
        if (Model.Count > 0)   {
        ordinamento = Model[0].order;
        ricerca = Model[0].search;
        }
}
<div class="dropdown col-md-4">
  <button type="button" class="btn btn-secondary dropdown-toggle" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    ordina per ...
    <span class="badge bg-warning" id="order-badge" style="color:black;">@ordinamento</span>
  </button>
  <div class="dropdown-menu dropdown-menu-dark" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" asp-action="Index" asp-route-order="pop" 
    asp-route-search="@ricerca">Popolarità</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" asp-action="Index" asp-route-order="pincr"
    asp-route-search="@ricerca">Prezzo Crescente</a>
    <a class="dropdown-item" asp-action="Index" asp-route-order="pdec"
    asp-route-search="@ricerca">Prezzo Decrescente</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" asp-action="Index" asp-route-order="alf"
    asp-route-search="@ricerca">Ordine Alfabetico</a>
    <a class="dropdown-item" asp-action="Index" asp-route-order="aut"
    asp-route-search="@ricerca">Autore</a>
  </div>
</div>

<div class="col-md-4">
        <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" name="search" placeholder="Cerca.." value="@ricerca"/>
        </form>
</div>

</div><!-- end of row class -->

@{   
    // CONTROLLA CHE LA CHIAVE SEARCH ABBIA TIRATO FUORI
    // ALMENO UN RECORD
    if (Model.Count > 0 )  {
foreach(CourseViewModel course in Model)
{
<hr>
<div class="row">
    <div class="col-md-1">
        <img src="@course.ImagePath" width="50">
    </div>
    <div class="col-md-5">
        <h2 class="titolo">@course.Title</h2>
        <author>di @course.Author</author>
    </div>
    <div class="col-md-2 rating" title="@course.Rating">
        
        @for (int i = 1; i <= 5; i++)
        {
            if (course.Rating >= i)
                {
                    <i class="fas fa-star"></i> 
                }
            else if (course.Rating > i - 1)
                {
                    <i class="fas fa-star-half-alt"></i> 
                }
            else
                {
                    <i class="far fa-star"></i> 
                }

        }

    </div>
    <div class="col-md-2">
        <div class="final-price">
            @course.CurrentPrice
        </div>
        @if(!course.CurrentPrice.Equals(course.FullPrice))
        {
        <div class="initial-price">
            <s>@course.FullPrice</s> 
        </div>
        }
    </div>
    <div class="col-md-2">
    <a class="btn btn-outline-primary"
    asp-action="Detail" asp-route-id="@course.Id">Dettagli</a>

    </div>
</div>
<br/>
}   // end @foreach
}   // end if
else
{
    // HTML NEL CASO IN CUI NON VENGA TROVATO NESSUN RECORD
    <h2>Nessun record trovato!</h2>
}
}
